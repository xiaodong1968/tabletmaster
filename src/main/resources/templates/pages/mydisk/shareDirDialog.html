<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name=renderer  content=webkit>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--[if lt IE 9]>
    <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
    <![endif]-->
    <meta name="_csrf" th:content="${_csrf.token}">
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <meta charset="UTF-8">
    <link th:href="@{/third/css/bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/third/font-awesome-4.7.0/css/font-awesome.css}" rel="stylesheet">
    <link th:href="@{/third/css/animate.css}" rel="stylesheet">
    <link th:href="@{/third/DataTables/datatables.min.css}" rel="stylesheet">
    <link th:href="@{/third/lib/layui/css/layui.css}" rel="stylesheet" type="text/css">
    <link th:href="@{/third/jtree/css/style.min.css}" rel="stylesheet" type="text/css"></link>
    <link th:href="@{/third/jtree/css/custom.css}" rel="stylesheet" type="text/css"></link>
    <link th:href="@{/third/jtree/css/awesome-bootstrap-checkbox.css}" rel="stylesheet" type="text/css"></link>
    <link th:href="@{/third/css/bootstrap_modify.css}" rel="stylesheet" type="text/css"></link>
    <title>新增群组</title>
    <style type="text/css">
        .users{
            float: left;
            text-align: left;
            background: rgb(111 151 147);
            height: 600px;
            width: 190px;
            overflow: scroll;
        }
        .users li{
            padding: 12px;
            color:white;
            border-bottom: 1px solid #b5b5a9;

        }
        .users li label{
            cursor:pointer;
        }
        .users li:first-child{
            padding: 0px;
        }
        .users li:first-child input{
            height: 30px;
            color:black;
            border:none;
            width: 100%;
        }
        .members{
            float: left;
            height: 600px;
            width: 100%;
            overflow: scroll;
        }
        .members li{
            background: #dae3da;
            padding: 10px;
            margin: 5px;
            border-radius: 5px;
            color: #536864;
            text-align: center;
            float:left;
            width: 200px;
            overflow: auto;
            cursor: pointer;
        }
        .hasadd{
            margin: 5px;
            text-align: center;
            float: left;
            width: 100%;
            position: relative;
            border-bottom: 1px solid #e1d9d9;
        }
        .hasadd_label{
            background: #dae3da;
            border-radius: 5px;
            color: #536864;
            padding: 10px;
            margin: 5px;
        }
        .hasadd_btn{
            margin: 5px;
            position: absolute;
            right: 15px;
            top:8px;
        }
        body{
            background: white;
            overflow: hidden;
        }
        .isAdmin{
            color:orangered;
        }
        .notAdmin{
            color: gray;
        }
    </style>
</head>
<body>
<div class="wrapper wrapper-content animated fadeInRight">
    <div class="row" style="margin: 0px">
        <div class="col-sm-12" style="margin: 0px;padding:0px;background: #f3f3f3">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <input type="hidden" th:value="${currentDir}" id="currentDir">
                    <div class="hasadd"><label class="hasadd_label">需要共享的群组</label><button class="btn btn-success hasadd_btn" onclick="saveGroup()">保存</button></div>
                    <ul class="members" id="members">
                        <li th:each="group:${groups}">
                            <input type="hidden" th:value="${group.id}">
                            <label th:text="${group.getName()}" style="font-size: 16px"></label>
                            <input type="checkbox" th:if="${group.checked}" checked class="isChecked">
                            <input type="checkbox" th:unless="${group.checked}"  class="isChecked">
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- 公共尾部开始 -->
<!-- 公共尾部开始 -->
<script th:src="@{/third/js/jquery.min.js}" type="text/javascript"></script>
<script th:src="@{/third/js/bootstrap.min.js}" type="text/javascript"></script>
<script th:src="@{/third/js/jquery.metisMenu.js}" type="text/javascript"></script>
<script th:src="@{/third/js/hAdmin.js}" type="text/javascript"></script>
<script th:src="@{/third/lib/layui/layui.all.js}" type="text/javascript"></script>
<script th:src="@{/third/js/jquery.validate.min.js}" type="text/javascript"></script>
<script th:src="@{/third/js/message_zh.min.js}" type="text/javascript"></script>
<script th:src="@{/third/js/validate_default.js}" type="text/javascript"></script>
<script th:src="@{/third/DataTables/datatables.min.js}" type="text/javascript"></script>
<script th:src="@{/third/js/jquery.slimscroll.min.js}" type="text/javascript"></script>
<script th:src="@{/third/js/global.js}" type="text/javascript"></script>
<script th:src="@{/third/js/sock.js}" type="text/javascript"></script>
<script th:src="@{/third/js/jquery.cookie.js}" type="text/javascript"></script>
<script th:src="@{/third/js/stomp.js}" type="text/javascript"></script>
<script th:src="@{/third/jtree/js/jstree.min.js}" type="text/javascript"></script>
<!-- 公共尾部结束 -->
<script>
    var groups=new Array();//已经选择的共享群组
    function saveGroup(){
        $(".isChecked").each(function(){
           if($(this).prop("checked")){
               var groupId=$(this).parent().find("input[type='hidden']").eq(0).val();
               groups.push(groupId);
           }
        });
        $.ajax({
            url:'shareDirToGroup',
            type:'post',
            data:{"currentDir":$("#currentDir").val(),"groups":groups},
            traditional:true,
            success:function(data){
                if(data==0){
                    layer.msg("操作失败");
                    return ;
                }
                if(data==1){
                    layer.msg("操作成功");
                    var index = parent.layer.getFrameIndex(window.name);
                    parent.layer.close(index);
                }
            }
        }) ;
    }
</script>
</body>
</html>