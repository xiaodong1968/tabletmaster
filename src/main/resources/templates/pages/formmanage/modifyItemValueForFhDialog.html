<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name=renderer  content=webkit>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--[if lt IE 9]>
    <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
    <![endif]-->
    <meta name="_csrf" th:content="${_csrf.token}">
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <meta charset="UTF-8">
    <link th:href="@{/third/css/bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/third/font-awesome-4.7.0/css/font-awesome.css}" rel="stylesheet">
    <link th:href="@{/third/css/animate.css}" rel="stylesheet">
    <link th:href="@{/third/DataTables/datatables.min.css}" rel="stylesheet">
    <link th:href="@{/third/lib/layui/css/layui.css}" rel="stylesheet" type="text/css">
    <link th:href="@{/third/jtree/css/style.min.css}" rel="stylesheet" type="text/css"></link>
    <link th:href="@{/third/jtree/css/custom.css}" rel="stylesheet" type="text/css"></link>
    <link th:href="@{/third/jtree/css/awesome-bootstrap-checkbox.css}" rel="stylesheet" type="text/css"></link>
    <link th:href="@{/third/css/bootstrap_modify.css}" rel="stylesheet" type="text/css"></link>
    <link th:href="@{/third/dist/plyr.css}" rel="stylesheet" type="text/css"></link>
    <title>复核评分</title>
    <style>
        body{
            background:white;
            overflow: hidden;
        }
        .contentWrap{
            text-align: center;
            padding: 20px;
            overflow: hidden;
        }
    </style>
</head>
<body>
<div class="contentWrap">
    <input type="hidden" id="itemId" th:value="${item.id}">
    <input type="hidden" id="valueLimit" th:value="${item.value_limit}">
    <label>请输入复核分值：</label><input type="text" id="fhPoint" th:value="${item.itemValue}" style="width: 300px">
    <br>
    <label style="display: block;width: 380px;color: #9f9595;font-size: 12px">提示：最大分值<label th:text="${item.value_limit}" style="color: red"></label>分</label>
    <br>
    <label>请输入复核意见：</label>
    <textarea id="fhMessage" th:text="${item.fhMessage}" placeholder="非必填,不能超过50个字" style="width: 300px;height:120px;vertical-align: top;">

    </textarea>
    <br><br>
    <label class="btn-sm btn-success" onclick="commitPoint()" style="width: 50px;text-align: center;display: block;margin: 0px auto">提交</label>
</div>
<!-- 公共尾部开始 -->
<!-- 公共尾部开始 -->
<script th:src="@{/third/js/jquery.min.js}" type="text/javascript"></script>
<script th:src="@{/third/js/bootstrap.min.js}" type="text/javascript"></script>
<script th:src="@{/third/js/jquery.metisMenu.js}" type="text/javascript"></script>
<script th:src="@{/third/js/hAdmin.js}" type="text/javascript"></script>
<!--<script th:src="@{/third/lib/layui/layui.all.js}" type="text/javascript"></script>-->
<script th:src="@{/third/layui/layui.js}" type="text/javascript"></script>
<script th:src="@{/third/js/jquery.validate.min.js}" type="text/javascript"></script>
<script th:src="@{/third/js/message_zh.min.js}" type="text/javascript"></script>
<script th:src="@{/third/js/validate_default.js}" type="text/javascript"></script>
<script th:src="@{/third/DataTables/datatables.min.js}" type="text/javascript"></script>
<script th:src="@{/third/js/jquery.slimscroll.min.js}" type="text/javascript"></script>
<script th:src="@{/third/js/global.js}" type="text/javascript"></script>
<script th:src="@{/third/js/sock.js}" type="text/javascript"></script>
<script th:src="@{/third/js/jquery.cookie.js}" type="text/javascript"></script>
<script th:src="@{/third/js/stomp.js}" type="text/javascript"></script>
<script th:src="@{/third/jtree/js/jstree.min.js}" type="text/javascript"></script>
<script th:src="@{/third/dist/plyr.js}" type="text/javascript"></script>
<!-- 公共尾部结束 -->
<script>

    //提交复核
    function commitPoint() {
        var itemId=$("#itemId").val();
        var valueLimit=$("#valueLimit").val();
        var fhPoint=$("#fhPoint").val();
        var fhMessage=$("#fhMessage").val();
        if(!(/^[0-9]+$|^[0-9]+[\.]{1,1}[0-9]{1,1}$/.test(fhPoint))){
            layer.msg("只能是整数或小数（小数点后最多保留1位）!");
            return ;
        }
        if( parseFloat(fhPoint) > parseFloat(valueLimit)){
            layer.msg("超出最大值!");
            return ;
        }
        if(fhMessage.length>50){
            layer.msg("复核意见不能超过50个字符!");
            return ;
        }
        $.ajax({
            url:"modifyItemValue",
            type:'post',
            data:{"itemId":itemId,"value":fhPoint,"fhMessage":fhMessage},
            success:function(data){
                if(data==1){
                    layer.msg("修改成功!");
                    layer.close(index);
                }else{
                    layer.msg("修改失败!");
                    layer.close(index);
                }
                var index = parent.layer.getFrameIndex(window.name);
                parent.layer.close(index);
            }
        });
    }
</script>
</body>
</html>